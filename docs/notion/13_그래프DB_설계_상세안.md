# ğŸ•¸ï¸ Risk Knowledge Graph ì„¤ê³„ ìƒì„¸ì•ˆ

## ê·¸ë˜í”„ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ì² í•™

> **í•µì‹¬ ì•„ì´ë””ì–´**: íŒŒí¸í™”ëœ ë¦¬ìŠ¤í¬ ì •ë³´ë¥¼ ì§€ì‹ ê·¸ë˜í”„ë¡œ ì—°ê²°í•˜ì—¬ ìˆ¨ê²¨ì§„ ì—°ê´€ê´€ê³„ë¥¼ ë°œê²¬
> 
> **ì„¤ê³„ ì›ì¹™**: í™•ì¥ì„±, ì‹¤ì‹œê°„ì„±, ì •í™•ì„±, ì§ê´€ì„±

---

## ğŸ¯ ë¬¸ì œ ì •ì˜ ë° ì„¤ê³„ ëª©í‘œ

### í•´ê²°í•˜ê³ ì í•˜ëŠ” ë¬¸ì œ
```yaml
ê¸°ì¡´ ë¦¬ìŠ¤í¬ ê´€ë¦¬ì˜ í•œê³„:
  ì •ë³´ íŒŒí¸í™”:
    - ë‰´ìŠ¤, ê³µì‹œ, SNS ë“± ë‹¤ì–‘í•œ ì†ŒìŠ¤ì˜ ê°œë³„ ë¶„ì„
    - ì—°ê´€ê´€ê³„ íŒŒì•…ì˜ ì–´ë ¤ì›€
    - ì‹œê°„ì— ë”°ë¥¸ ê´€ê³„ ë³€í™” ì¶”ì  ë¶ˆê°€

  ë¦¬ìŠ¤í¬ ì „íŒŒ ì˜ˆì¸¡ ë¶ˆê°€:
    - AíšŒì‚¬ ë¦¬ìŠ¤í¬ê°€ BíšŒì‚¬ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë¶„ì„ ì–´ë ¤ì›€
    - ê³µê¸‰ë§, ê²½ìŸê´€ê³„, ì¸ì  ë„¤íŠ¸ì›Œí¬ ë³µí•© íš¨ê³¼
    - ê°„ì ‘ì  ì—°ê²°ê³ ë¦¬ë¥¼ í†µí•œ ìˆ¨ê²¨ì§„ ë¦¬ìŠ¤í¬

  ì‹¤ì‹œê°„ ëŒ€ì‘ í•œê³„:
    - ì •ì  ë¶„ì„ìœ¼ë¡œ ì¸í•œ ì‹œì˜ì„± ë¶€ì¡±
    - ë™ì  ê´€ê³„ ë³€í™” ë°˜ì˜ ë¶ˆê°€
    - ì˜ˆì¸¡ì  ì¸ì‚¬ì´íŠ¸ ì œê³µ í•œê³„
```

### ê·¸ë˜í”„ DB ì„¤ê³„ ëª©í‘œ
```yaml
ê¸°ëŠ¥ì  ëª©í‘œ:
  1. ì‹¤ì‹œê°„ ê´€ê³„ ì—…ë°ì´íŠ¸: ë‰´ìŠ¤ ë°œìƒ í›„ 5ë¶„ ë‚´ ê·¸ë˜í”„ ë°˜ì˜
  2. ë³µì¡í•œ ê²½ë¡œ ë¶„ì„: 6ë‹¨ê³„ ì´ë‚´ ëª¨ë“  ì—°ê²° ê´€ê³„ ì¶”ì 
  3. ì‹œê³„ì—´ ê´€ê³„ ì§„í™”: ì‹œê°„ì— ë”°ë¥¸ ê´€ê³„ ê°•ë„ ë³€í™” ëª¨ë¸ë§
  4. ì˜ˆì¸¡ì  ë¶„ì„: ê³¼ê±° íŒ¨í„´ ê¸°ë°˜ ë¯¸ë˜ ê´€ê³„ ì˜ˆì¸¡

ì„±ëŠ¥ ëª©í‘œ:
  1. ì¿¼ë¦¬ ì‘ë‹µì‹œê°„: <100ms (P95, ë‹¨ìˆœ ì¿¼ë¦¬)
  2. ë³µì¡ ë¶„ì„: <1ì´ˆ (ë‹¤ë‹¨ê³„ ê´€ê³„ ë¶„ì„)
  3. ë™ì‹œ ì—°ê²°: 1000+ concurrent users
  4. ë…¸ë“œ í™•ì¥ì„±: 1M+ ë…¸ë“œ, 10M+ ê´€ê³„

ì •í™•ë„ ëª©í‘œ:
  1. ê´€ê³„ ì¶”ì¶œ ì •í™•ë„: 95%+
  2. ì¤‘ìš”ë„ ê³„ì‚° ì‹ ë¢°ë„: 90%+
  3. ì˜ˆì¸¡ ì •í™•ë„: 80%+ (24ì‹œê°„)
  4. ì´ìƒ ê´€ê³„ íƒì§€: 90%+
```

---

## ğŸ—ï¸ ê·¸ë˜í”„ ìŠ¤í‚¤ë§ˆ ì„¤ê³„

### í•µì‹¬ ë…¸ë“œ íƒ€ì…
```cypher
// 1. ê¸°ì—… ë…¸ë“œ (Company)
CREATE CONSTRAINT company_id FOR (c:Company) REQUIRE c.id IS UNIQUE;
CREATE INDEX company_name_index FOR (c:Company) ON (c.name);
CREATE INDEX company_industry_index FOR (c:Company) ON (c.industry);

(:Company {
  id: "samsung_electronics_001",
  name: "ì‚¼ì„±ì „ì",
  english_name: "Samsung Electronics",
  stock_code: "005930",
  industry: "ë°˜ë„ì²´",
  sub_industry: "ë©”ëª¨ë¦¬ë°˜ë„ì²´",
  market_cap: 426000000000000,  // 426ì¡°ì›
  employees: 267937,
  founded_year: 1969,
  headquarters: "ê²½ê¸°ë„ ìˆ˜ì›ì‹œ",
  ceo: "ê¹€ê¸°ë‚¨",
  is_public: true,
  is_chaebol: true,
  chaebol_group: "ì‚¼ì„±ê·¸ë£¹",
  risk_score: 25.5,
  influence_score: 98.7,
  created_at: datetime(),
  updated_at: datetime()
})

// 2. ì¸ë¬¼ ë…¸ë“œ (Person)
CREATE CONSTRAINT person_id FOR (p:Person) REQUIRE p.id IS UNIQUE;
CREATE INDEX person_name_index FOR (p:Person) ON (p.name);

(:Person {
  id: "kim_ki_nam_001",
  name: "ê¹€ê¸°ë‚¨",
  english_name: "Kim Ki-nam",
  birth_year: 1957,
  education: ["ì„œìš¸ëŒ€í•™êµ ì „ìê³µí•™ê³¼", "Stanford MBA"],
  career_summary: "ì‚¼ì„±ì „ì 30ë…„ ê·¼ë¬´, ë°˜ë„ì²´ ì‚¬ì—… ì „ë¬¸ê°€",
  current_positions: ["ì‚¼ì„±ì „ì CEO", "ì‚¼ì„±ê·¸ë£¹ ì‚¬ì¥"],
  influence_score: 87.3,
  risk_profile: "ë³´ìˆ˜ì ",
  created_at: datetime(),
  updated_at: datetime()
})

// 3. ë‰´ìŠ¤ ë…¸ë“œ (News)
CREATE CONSTRAINT news_id FOR (n:News) REQUIRE n.id IS UNIQUE;
CREATE INDEX news_date_index FOR (n:News) ON (n.published_at);
CREATE INDEX news_source_index FOR (n:News) ON (n.source);

(:News {
  id: "chosun_20250719_001",
  title: "ì‚¼ì„±ì „ì, ì‹ ê·œ ë°˜ë„ì²´ ê³µì¥ íˆ¬ì ë°œí‘œ",
  url: "https://www.chosun.com/...",
  content: "ì‚¼ì„±ì „ìê°€ ê²½ê¸°ë„ í‰íƒì—...",
  source: "ì¡°ì„ ì¼ë³´",
  author: "ê¹€ê¸°ì",
  published_at: datetime("2025-07-19T10:30:00Z"),
  sentiment_score: 0.75,  // -1(ë¶€ì •) ~ +1(ê¸ì •)
  importance_score: 0.85,  // 0 ~ 1
  risk_score: 0.2,  // 0(ì•ˆì „) ~ 1(ìœ„í—˜)
  view_count: 15420,
  share_count: 234,
  created_at: datetime(),
  processed_at: datetime()
})

// 4. ë¦¬ìŠ¤í¬ ë…¸ë“œ (Risk)
CREATE CONSTRAINT risk_id FOR (r:Risk) REQUIRE r.id IS UNIQUE;
CREATE INDEX risk_category_index FOR (r:Risk) ON (r.category);

(:Risk {
  id: "supply_chain_risk_001",
  name: "ê³µê¸‰ë§ ë¦¬ìŠ¤í¬",
  category: "operational",  // financial, operational, legal, market, esg
  subcategory: "supply_chain",
  description: "ì£¼ìš” ê³µê¸‰ì—…ì²´ ì¤‘ë‹¨ìœ¼ë¡œ ì¸í•œ ìƒì‚° ì°¨ì§ˆ",
  severity: "high",  // low, medium, high, critical
  probability: 0.3,  // 0 ~ 1
  impact_score: 0.8,  // 0 ~ 1
  risk_score: 0.24,  // probability * impact_score
  first_detected: datetime("2025-07-19T09:15:00Z"),
  last_updated: datetime(),
  status: "active"  // active, monitoring, resolved
})

// 5. ì´ë²¤íŠ¸ ë…¸ë“œ (Event)
CREATE CONSTRAINT event_id FOR (e:Event) REQUIRE e.id IS UNIQUE;

(:Event {
  id: "semiconductor_investment_2025",
  name: "ë°˜ë„ì²´ ëŒ€ê·œëª¨ íˆ¬ì ë°œí‘œ",
  type: "business_announcement",
  date: date("2025-07-19"),
  location: "ì„œìš¸",
  significance: 0.9,  // 0 ~ 1
  related_industries: ["ë°˜ë„ì²´", "ì „ì"],
  economic_impact: 5000000000000,  // 5ì¡°ì›
  created_at: datetime()
})
```

### í•µì‹¬ ê´€ê³„ íƒ€ì…
```cypher
// 1. ê¸°ì—… ê°„ ê´€ê³„
// ê²½ìŸ ê´€ê³„
(samsung:Company)-[:COMPETES_WITH {
  intensity: 0.8,  // ê²½ìŸ ê°•ë„ (0~1)
  market_overlap: ["ë©”ëª¨ë¦¬ë°˜ë„ì²´", "ìŠ¤ë§ˆíŠ¸í°"],
  started_date: date("2000-01-01"),
  relationship_strength: 0.7,
  created_at: datetime(),
  updated_at: datetime()
}]->(sk_hynix:Company)

// ê³µê¸‰ì—…ì²´ ê´€ê³„
(samsung:Company)-[:SUPPLIES_TO {
  supply_ratio: 0.15,  // ê³µê¸‰ ë¹„ì¤‘
  criticality: 0.9,  // ì¤‘ìš”ë„
  contract_value: 500000000000,  // 5000ì–µì›
  contract_period: "2023-2025",
  dependency_score: 0.7,
  created_at: datetime()
}]->(apple:Company)

// ê³„ì—´ì‚¬ ê´€ê³„
(samsung_electronics:Company)-[:SUBSIDIARY_OF {
  ownership_ratio: 0.2078,  // ì§€ë¶„ìœ¨
  control_type: "indirect",  // direct, indirect
  voting_rights: 0.25,
  established_date: date("1969-01-13"),
  relationship_strength: 0.95
}]->(samsung_group:Company)

// 2. ì¸ë¬¼-ê¸°ì—… ê´€ê³„
(kim_ki_nam:Person)-[:WORKS_FOR {
  position: "CEO",
  start_date: date("2017-10-01"),
  employment_type: "executive",
  influence_level: 0.95,
  decision_authority: ["investment", "strategy", "personnel"],
  compensation: 2500000000,  // 25ì–µì›
  created_at: datetime()
}]->(samsung:Company)

(kim_ki_nam:Person)-[:BOARD_MEMBER {
  board_type: "internal",  // internal, external, independent
  committee_memberships: ["ê²½ì˜ìœ„ì›íšŒ", "íˆ¬ììœ„ì›íšŒ"],
  voting_power: 0.12,
  start_date: date("2017-10-01")
}]->(samsung:Company)

// 3. ë‰´ìŠ¤-ì—”í‹°í‹° ê´€ê³„
(news:News)-[:MENTIONS {
  mention_count: 5,
  sentiment_context: "positive",
  relevance_score: 0.9,
  position_in_article: "headline",  // headline, body, conclusion
  extracted_at: datetime()
}]->(samsung:Company)

(news:News)-[:MENTIONS {
  mention_count: 2,
  sentiment_context: "neutral",
  relevance_score: 0.7,
  position_in_article: "body"
}]->(kim_ki_nam:Person)

// 4. ë¦¬ìŠ¤í¬-ì—”í‹°í‹° ê´€ê³„
(supply_risk:Risk)-[:AFFECTS {
  impact_probability: 0.3,
  impact_magnitude: 0.8,
  time_horizon: "short_term",  // short_term, medium_term, long_term
  mitigation_difficulty: 0.6,
  first_linked: datetime(),
  confidence_score: 0.85
}]->(samsung:Company)

// 5. ì‹œê³„ì—´ ê´€ê³„ (ë™ì  ê´€ê³„ ëª¨ë¸ë§)
(samsung:Company)-[:RISK_CORRELATION {
  correlation_coefficient: 0.65,
  observation_period: "2024-01-01_2025-07-19",
  statistical_significance: 0.95,
  trend_direction: "increasing",  // increasing, decreasing, stable
  volatility: 0.3,
  last_calculated: datetime()
}]->(sk_hynix:Company)
```

---

## âš¡ ì„±ëŠ¥ ìµœì í™” ì „ëµ

### ì¸ë±ì‹± ì „ëµ
```cypher
-- 1. ì£¼ìš” ì†ì„± ì¸ë±ìŠ¤
CREATE INDEX company_risk_score FOR (c:Company) ON (c.risk_score);
CREATE INDEX news_sentiment_score FOR (n:News) ON (n.sentiment_score);
CREATE INDEX risk_severity FOR (r:Risk) ON (r.severity);
CREATE INDEX person_influence FOR (p:Person) ON (p.influence_score);

-- 2. ë³µí•© ì¸ë±ìŠ¤ (ìì£¼ í•¨ê»˜ ì¿¼ë¦¬ë˜ëŠ” ì†ì„±)
CREATE INDEX company_industry_risk FOR (c:Company) ON (c.industry, c.risk_score);
CREATE INDEX news_date_source FOR (n:News) ON (n.published_at, n.source);
CREATE INDEX risk_category_severity FOR (r:Risk) ON (r.category, r.severity);

-- 3. ì „ë¬¸ ê²€ìƒ‰ ì¸ë±ìŠ¤
CALL db.index.fulltext.createNodeIndex("company_search", ["Company"], ["name", "english_name"]);
CALL db.index.fulltext.createNodeIndex("news_search", ["News"], ["title", "content"]);
CALL db.index.fulltext.createNodeIndex("person_search", ["Person"], ["name", "english_name"]);

-- 4. ì‹œê°„ ê¸°ë°˜ íŒŒí‹°ì…”ë‹ ì¤€ë¹„
CREATE INDEX news_monthly FOR (n:News) ON (n.published_at) WHERE n.published_at >= datetime("2025-01-01");
```

### ì¿¼ë¦¬ ìµœì í™” íŒ¨í„´
```cypher
-- 1. íš¨ìœ¨ì ì¸ ê²½ë¡œ íƒìƒ‰ (ìµœë‹¨ ê²½ë¡œ)
MATCH path = shortestPath((source:Company {name: "ì‚¼ì„±ì „ì"})-[*..5]-(target:Company {name: "ì• í”Œ"}))
WHERE ALL(rel in relationships(path) WHERE rel.relationship_strength > 0.3)
RETURN path, length(path) as distance,
       reduce(strength = 1.0, rel in relationships(path) | strength * rel.relationship_strength) as path_strength
ORDER BY path_strength DESC
LIMIT 10;

-- 2. ì‹œê°„ ìœˆë„ìš° ê¸°ë°˜ ë¶„ì„ (ìµœê·¼ 24ì‹œê°„)
MATCH (c:Company {name: "ì‚¼ì„±ì „ì"})-[:MENTIONED_IN]->(n:News)
WHERE n.published_at > datetime() - duration('PT24H')
WITH c, COUNT(n) as mention_count, AVG(n.sentiment_score) as avg_sentiment
RETURN c.name, mention_count, avg_sentiment,
       CASE 
         WHEN avg_sentiment > 0.3 THEN "ê¸ì •ì "
         WHEN avg_sentiment < -0.3 THEN "ë¶€ì •ì "
         ELSE "ì¤‘ë¦½ì "
       END as sentiment_trend;

-- 3. ì˜í–¥ë ¥ ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ ë¶„ì„
MATCH (center:Company {name: "ì‚¼ì„±ì „ì"})
CALL gds.pageRank.stream('company-network', {
  sourceNodes: [center],
  relationshipWeightProperty: 'relationship_strength'
})
YIELD nodeId, score
WITH gds.util.asNode(nodeId) as company, score
WHERE company.name <> "ì‚¼ì„±ì „ì"
RETURN company.name, company.industry, score as influence_score
ORDER BY score DESC
LIMIT 20;

-- 4. ë¦¬ìŠ¤í¬ ì „íŒŒ ì‹œë®¬ë ˆì´ì…˜
MATCH (source:Company {name: "ì‚¼ì„±ì „ì"})-[r*1..3]-(affected:Company)
WHERE ALL(rel in r WHERE rel.relationship_strength > 0.2)
WITH affected, 
     length(r) as distance,
     reduce(propagation = 1.0, rel in r | propagation * rel.relationship_strength) as risk_propagation
WHERE risk_propagation > 0.1
RETURN affected.name, affected.industry, distance, risk_propagation,
       CASE distance
         WHEN 1 THEN "ì§ì ‘ ì˜í–¥"
         WHEN 2 THEN "2ì°¨ ì˜í–¥"
         ELSE "3ì°¨ ì˜í–¥"
       END as impact_type
ORDER BY risk_propagation DESC;
```

---

## ğŸ“Š ê³ ê¸‰ ë¶„ì„ ì•Œê³ ë¦¬ì¦˜

### 1. ì¤‘ì‹¬ì„± ë¶„ì„ (Centrality Analysis)
```cypher
-- PageRank: ì „ì²´ì  ì˜í–¥ë ¥ ì¸¡ì •
CALL gds.pageRank.write('company-network', {
  writeProperty: 'pagerank_score',
  relationshipWeightProperty: 'relationship_strength',
  dampingFactor: 0.85,
  maxIterations: 20
});

-- Betweenness Centrality: ì¤‘ê°œì ì—­í•  ì¸¡ì •
CALL gds.betweenness.write('company-network', {
  writeProperty: 'betweenness_score'
});

-- Closeness Centrality: ì •ë³´ ì „íŒŒ ì†ë„ ì¸¡ì •
CALL gds.closeness.write('company-network', {
  writeProperty: 'closeness_score'
});

-- í†µí•© ì¤‘ìš”ë„ ì ìˆ˜ ê³„ì‚°
MATCH (c:Company)
SET c.importance_score = 
  (c.pagerank_score * 0.5) + 
  (c.betweenness_score * 0.3) + 
  (c.closeness_score * 0.2);
```

### 2. ì»¤ë®¤ë‹ˆí‹° íƒì§€ (Community Detection)
```cypher
-- Louvain Algorithm: ì—…ì¢…ë³„ í´ëŸ¬ìŠ¤í„°ë§
CALL gds.louvain.write('company-network', {
  writeProperty: 'community_id',
  relationshipWeightProperty: 'relationship_strength',
  includeIntermediateCommunities: false
});

-- ì»¤ë®¤ë‹ˆí‹°ë³„ íŠ¹ì„± ë¶„ì„
MATCH (c:Company)
WITH c.community_id as community, 
     collect(c.industry) as industries,
     avg(c.risk_score) as avg_risk,
     count(c) as company_count
RETURN community, 
       company_count,
       avg_risk,
       [industry in industries | industry][0..5] as top_industries;
```

### 3. ë§í¬ ì˜ˆì¸¡ (Link Prediction)
```cypher
-- ê³µí†µ ì´ì›ƒ ê¸°ë°˜ ìƒˆë¡œìš´ ê´€ê³„ ì˜ˆì¸¡
MATCH (a:Company)-[:COMPETES_WITH|SUPPLIES_TO]-(common)-[:COMPETES_WITH|SUPPLIES_TO]-(b:Company)
WHERE a <> b AND NOT (a)-[:COMPETES_WITH|SUPPLIES_TO]-(b)
WITH a, b, count(common) as common_neighbors
WHERE common_neighbors >= 2
RETURN a.name, b.name, common_neighbors,
       common_neighbors * 0.1 as predicted_relationship_strength
ORDER BY common_neighbors DESC
LIMIT 50;
```

### 4. ì´ìƒ íƒì§€ (Anomaly Detection)
```cypher
-- ë¹„ì •ìƒì ì¸ ê´€ê³„ íŒ¨í„´ íƒì§€
MATCH (c:Company)-[r:MENTIONED_IN]->(n:News)
WHERE n.published_at > datetime() - duration('P7D')
WITH c, count(r) as mention_count, avg(n.sentiment_score) as avg_sentiment
WITH avg(mention_count) as global_avg_mentions, 
     stdev(mention_count) as stdev_mentions,
     collect({company: c, mentions: mention_count, sentiment: avg_sentiment}) as companies
UNWIND companies as company_data
WITH company_data, global_avg_mentions, stdev_mentions
WHERE abs(company_data.mentions - global_avg_mentions) > 2 * stdev_mentions
RETURN company_data.company.name as company,
       company_data.mentions as mention_count,
       global_avg_mentions as normal_range,
       CASE 
         WHEN company_data.mentions > global_avg_mentions THEN "ê¸‰ì¦"
         ELSE "ê¸‰ê°"
       END as anomaly_type,
       company_data.sentiment as sentiment_score;
```

---

## ğŸ”„ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ë©”ì»¤ë‹ˆì¦˜

### ì´ë²¤íŠ¸ ê¸°ë°˜ ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
```python
# Kafka Consumerë¥¼ í†µí•œ ì‹¤ì‹œê°„ ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
class GraphUpdateConsumer:
    def __init__(self, neo4j_driver, kafka_consumer):
        self.driver = neo4j_driver
        self.consumer = kafka_consumer
    
    def process_news_event(self, news_data):
        """ìƒˆë¡œìš´ ë‰´ìŠ¤ ë°ì´í„°ë¥¼ ë°›ì•„ ê·¸ë˜í”„ë¥¼ ì—…ë°ì´íŠ¸"""
        with self.driver.session() as session:
            # 1. ë‰´ìŠ¤ ë…¸ë“œ ìƒì„±
            session.run("""
                CREATE (n:News {
                    id: $news_id,
                    title: $title,
                    content: $content,
                    source: $source,
                    published_at: datetime($published_at),
                    sentiment_score: $sentiment_score,
                    processed_at: datetime()
                })
            """, **news_data)
            
            # 2. ì—”í‹°í‹° ê´€ê³„ ìƒì„±
            for entity in news_data['entities']:
                session.run("""
                    MATCH (n:News {id: $news_id})
                    MATCH (e {id: $entity_id})
                    CREATE (n)-[:MENTIONS {
                        mention_count: $mention_count,
                        sentiment_context: $sentiment,
                        relevance_score: $relevance,
                        extracted_at: datetime()
                    }]->(e)
                """, news_id=news_data['id'], **entity)
            
            # 3. ê´€ê³„ ê°•ë„ ì—…ë°ì´íŠ¸
            self.update_relationship_strengths(session, news_data)
    
    def update_relationship_strengths(self, session, news_data):
        """ë‰´ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ê¸°ì—… ê°„ ê´€ê³„ ê°•ë„ ì¬ê³„ì‚°"""
        session.run("""
            MATCH (c1:Company)-[r:COMPETES_WITH|SUPPLIES_TO]-(c2:Company)
            MATCH (c1)<-[:MENTIONS]-(n:News)-[:MENTIONS]->(c2)
            WHERE n.published_at > datetime() - duration('P30D')
            WITH r, count(n) as co_mention_count
            SET r.co_mention_frequency = co_mention_count,
                r.relationship_strength = 
                    CASE 
                        WHEN co_mention_count > 10 THEN 0.9
                        WHEN co_mention_count > 5 THEN 0.7
                        WHEN co_mention_count > 2 THEN 0.5
                        ELSE 0.3
                    END,
                r.updated_at = datetime()
        """)
```

### ë°°ì¹˜ ì²˜ë¦¬ë¥¼ í†µí•œ ì •ê¸° ì—…ë°ì´íŠ¸
```cypher
-- ì¼ê°„ ë°°ì¹˜: ì˜í–¥ë ¥ ì ìˆ˜ ì¬ê³„ì‚°
CALL apoc.periodic.iterate(
  "MATCH (c:Company) RETURN c",
  "
  MATCH (c)-[:MENTIONED_IN]->(n:News)
  WHERE n.published_at > datetime() - duration('P30D')
  WITH c, 
       count(n) as mention_count,
       avg(n.sentiment_score) as avg_sentiment,
       avg(n.importance_score) as avg_importance
  SET c.influence_score = 
    (mention_count * 0.4) + 
    ((avg_sentiment + 1) * 25 * 0.3) + 
    (avg_importance * 100 * 0.3),
    c.last_influence_update = datetime()
  ",
  {batchSize: 100, parallel: true}
);

-- ì£¼ê°„ ë°°ì¹˜: ì»¤ë®¤ë‹ˆí‹° ì¬íƒì§€
CALL gds.louvain.write('company-network', {
  writeProperty: 'community_id_weekly',
  relationshipWeightProperty: 'relationship_strength'
});
```

---

## ğŸ“ˆ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬

### ë°ì´í„° ê²€ì¦ ê·œì¹™
```cypher
-- 1. ì¼ê´€ì„± ê²€ì¦
MATCH (c:Company)
WHERE c.risk_score < 0 OR c.risk_score > 100
RETURN "Invalid risk_score detected" as issue, c.name, c.risk_score;

-- 2. ê´€ê³„ ë¬´ê²°ì„± ê²€ì¦
MATCH (n:News)-[r:MENTIONS]->(e)
WHERE NOT (e:Company OR e:Person OR e:Event)
RETURN "Invalid MENTIONS relationship" as issue, n.id, type(e);

-- 3. ì‹œê°„ ì¼ê´€ì„± ê²€ì¦
MATCH (p:Person)-[r:WORKS_FOR]->(c:Company)
WHERE r.start_date > date()
RETURN "Future employment date" as issue, p.name, c.name, r.start_date;

-- 4. ì¤‘ë³µ ë°ì´í„° íƒì§€
MATCH (c1:Company), (c2:Company)
WHERE c1.name = c2.name AND c1.id <> c2.id
RETURN "Duplicate company names" as issue, c1.name, c1.id, c2.id;
```

### ìë™ ì •ì œ í”„ë¡œì„¸ìŠ¤
```cypher
-- 1. ê´€ê³„ ê°•ë„ ì •ê·œí™”
MATCH ()-[r:COMPETES_WITH|SUPPLIES_TO]-()
WHERE r.relationship_strength > 1.0
SET r.relationship_strength = 1.0,
    r.normalized_at = datetime();

-- 2. ì˜¤ë˜ëœ ë°ì´í„° ì•„ì¹´ì´ë¹™
MATCH (n:News)
WHERE n.published_at < datetime() - duration('P1Y')
SET n:ArchivedNews
REMOVE n:News;

-- 3. ê³ ì•„ ë…¸ë“œ ì •ë¦¬
MATCH (orphan)
WHERE NOT (orphan)--()
AND labels(orphan) IN [["TempEntity"], ["ProcessingNode"]]
DELETE orphan;
```

---

## ğŸ”® í™•ì¥ì„± ë° ë¯¸ë˜ ê³„íš

### ìˆ˜í‰ í™•ì¥ ì „ëµ
```yaml
Phase 2 í™•ì¥ (Single Cluster):
  ë…¸ë“œ ëª©í‘œ: 1M+ (Company: 100K, Person: 500K, News: 500K)
  ê´€ê³„ ëª©í‘œ: 10M+ 
  ë©”ëª¨ë¦¬: 64GB RAM
  ìŠ¤í† ë¦¬ì§€: 1TB SSD
  
Phase 3 í™•ì¥ (Multi-Cluster):
  ì§€ì—­ë³„ ë¶„ì‚°:
    - ì„œìš¸ í´ëŸ¬ìŠ¤í„°: í•œêµ­ ë°ì´í„° (Primary)
    - ë„ì¿„ í´ëŸ¬ìŠ¤í„°: ì•„ì‹œì•„ í™•ì¥
    - ì‹¤ë¦¬ì½˜ë°¸ë¦¬: ê¸€ë¡œë²Œ ë°ì´í„°
  
  ìƒ¤ë”© ì „ëµ:
    - Geographic sharding (ì§€ì—­ë³„)
    - Industry sharding (ì—…ì¢…ë³„)
    - Time-based sharding (ì‹œê°„ë³„)
```

### ì°¨ì„¸ëŒ€ ê¸°ëŠ¥ ì¤€ë¹„
```cypher
-- 1. ì‹œê°„ ê¸°ë°˜ ê·¸ë˜í”„ ìŠ¤ëƒ…ìƒ·
CREATE (snapshot:GraphSnapshot {
  snapshot_id: "daily_20250719",
  created_at: datetime(),
  node_count: 50000,
  relationship_count: 250000,
  average_clustering: 0.65
});

-- 2. ê·¸ë˜í”„ ì„ë² ë”© ì¤€ë¹„
CALL gds.node2vec.write('company-network', {
  writeProperty: 'embedding',
  dimensions: 128,
  walkLength: 10,
  walks: 10
});

-- 3. ì˜ˆì¸¡ ëª¨ë¸ í†µí•© ì¤€ë¹„
CREATE (prediction:RiskPrediction {
  model_id: "lstm_risk_predictor_v1",
  prediction_horizon: "24_hours",
  confidence_interval: 0.85,
  last_trained: datetime(),
  features: ["pagerank", "sentiment_trend", "mention_frequency"]
});
```

---

## ğŸ¯ ì„±ê³µ ì§€í‘œ ë° ëª¨ë‹ˆí„°ë§

### ê·¸ë˜í”„ í’ˆì§ˆ ì§€í‘œ
```cypher
-- 1. ê·¸ë˜í”„ ë°€ë„ (ì—°ê²°ì„± ì¸¡ì •)
MATCH (n)
WITH count(n) as node_count
MATCH ()-[r]-()
WITH node_count, count(r) as relationship_count
RETURN relationship_count / (node_count * (node_count - 1)) as graph_density;

-- 2. í´ëŸ¬ìŠ¤í„°ë§ ê³„ìˆ˜ (ë„¤íŠ¸ì›Œí¬ ì‘ì§‘ë„)
CALL gds.localClusteringCoefficient.stats('company-network')
YIELD averageClusteringCoefficient;

-- 3. ì—°ê²° ì„±ë¶„ ë¶„ì„ (ë„¤íŠ¸ì›Œí¬ ë¶„ì ˆë„)
CALL gds.wcc.stats('company-network')
YIELD componentCount, componentDistribution;

-- 4. ì§ê²½ ì¸¡ì • (ìµœëŒ€ ê²½ë¡œ ê¸¸ì´)
CALL gds.alpha.diameter.stream('company-network')
YIELD diameter;
```

### ë¹„ì¦ˆë‹ˆìŠ¤ ì„íŒ©íŠ¸ ì¸¡ì •
```yaml
ì§ì ‘ì  ê°€ì¹˜:
  - ìˆ¨ê²¨ì§„ ì—°ê²°ê³ ë¦¬ ë°œê²¬: ì›” 100ê°œ+ ì¸ì‚¬ì´íŠ¸
  - ë¦¬ìŠ¤í¬ ì˜ˆì¸¡ ì •í™•ë„: 80%+ (24ì‹œê°„ ì˜ˆì¸¡)
  - ì˜ì‚¬ê²°ì • ì†ë„: 50% í–¥ìƒ (ê·¸ë˜í”„ ê¸°ë°˜ ë¶„ì„)
  - ì¡°ê¸° ê²½ë³´ ì„±ê³µë¥ : 70%+ (ì‹¤ì œ ë¦¬ìŠ¤í¬ ëŒ€ë¹„)

ê°„ì ‘ì  ê°€ì¹˜:
  - CEO ì‹ ë¢°ë„: 90%+ (ê·¸ë˜í”„ ì¸ì‚¬ì´íŠ¸ ë§Œì¡±ë„)
  - ë¶„ì„ê°€ ìƒì‚°ì„±: 3ë°° í–¥ìƒ (ìˆ˜ë™ ë¶„ì„ ëŒ€ë¹„)
  - ë¦¬ìŠ¤í¬ ê´€ë¦¬ íš¨ìœ¨ì„±: 60% í–¥ìƒ
  - ì „ëµì  ì˜ì‚¬ê²°ì • í’ˆì§ˆ: ì •ì„±ì  ê°œì„ 
```

---

*ìµœì¢… ì—…ë°ì´íŠ¸: 2025-07-19*